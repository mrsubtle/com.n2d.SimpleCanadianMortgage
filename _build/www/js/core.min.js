/*! com.n2d.SimpleCanadianMortgage 22-02-2016 */
"use strict";function require(script){$.ajax({url:"js/"+script,dataType:"script",async:!1,success:function(){console.warn("Loaded external file: "+script)},error:function(){throw new Error("Could not load script "+script)}})}require("inc/configure.js"),require("inc/logger.js"),require("inc/touch.js"),require("inc/views.js");var meta={locale:"",isOnline:!1,data:{principal:2e5,amortization:300,rate:.01111,frequency:26,downPercent:.05,downAmount:1e4,ltv:.95,insurableAmount:19e4,insuranceTeir:1,insurancePercent:.036,insuranceAmount:6840,transactionType:0,financedAmount:196840}},cmhc={purchase:[{ltvMin:.9001,ltvMax:.95,rate:.0385},{ltvMin:0,ltvMax:.95,rate:.036},{ltvMin:0,ltvMax:.9,rate:.024},{ltvMin:0,ltvMax:.85,rate:.018},{ltvMin:0,ltvMax:.8,rate:.0125},{ltvMin:0,ltvMax:.75,rate:.0075},{ltvMin:0,ltvMax:.6,rate:.006}],refinance:[{ltvMin:1,ltvMax:1,rate:0},{ltvMin:1,ltvMax:1,rate:0},{ltvMin:1,ltvMax:1,rate:0},{ltvMin:1,ltvMax:1,rate:0},{ltvMin:0,ltvMax:.8,rate:.0315},{ltvMin:0,ltvMax:.75,rate:.026},{ltvMin:0,ltvMax:.6,rate:.006}],portability:[{ltvMin:1,ltvMax:1,rate:0},{ltvMin:0,ltvMax:0,rate:0},{ltvMin:0,ltvMax:0,rate:0},{ltvMin:0,ltvMax:0,rate:0},{ltvMin:0,ltvMax:.8,rate:.0315},{ltvMin:0,ltvMax:.75,rate:.026},{ltvMin:0,ltvMax:.6,rate:.006}]},utility={getPayment:function(principal,numPmtsYr,interestRate,amortization){var p=principal,n=numPmtsYr,i=interestRate,a=amortization,payment=0;return payment=i/n*p/(1-Math.pow(1+i/n,-1*a*n)),payment=Math.round(payment),payment=0==isFinite(payment)?"-":utility.formatNumber(payment,0,0,!0)},formatNumber:function(number,digits,decimalPlaces,withCommas){number=number.toString();for(var simpleNumber="",i=0;i<number.length;++i)"0123456789.".indexOf(number.charAt(i))>=0&&(simpleNumber+=number.charAt(i));number=parseFloat(simpleNumber),isNaN(number)&&(number=0),null==withCommas&&(withCommas=!1),0==digits&&(digits=1);for(var integerPart=decimalPlaces>0?Math.floor(number):Math.round(number),string="",i=0;digits>i||integerPart>0;++i)withCommas&&string.match(/^\d\d\d/)&&(string=","+string),string=integerPart%10+string,integerPart=Math.floor(integerPart/10);return decimalPlaces>0&&(number-=Math.floor(number),number*=Math.pow(10,decimalPlaces),string+="."+utility.formatNumber(number,decimalPlaces,0)),"0.00"!=string?string:void 0}},app={initialize:function(){app.bindEvents()},bindEvents:function(){document.addEventListener("deviceready",this.onDeviceReady,!1),document.addEventListener("online",this.onDeviceOnline,!1),document.addEventListener("offline",this.onDeviceOffline,!1),document.addEventListener("load",this.onAppLoad,!1),document.addEventListener("pause",this.onAppPaused,!1),document.addEventListener("resume",this.onAppResumed,!1)},onDeviceReady:function(){console.log("Device ready, yo"),meta.isOnline&&Parse.initialize(config.parse.ApplicationID,config.parse.JavascriptKey),app.setLocale(),$("screen#calculate helper").removeClass("hide"),views.initialize(),touch.initialize()},onDeviceOnline:function(){console.log("Internet connection confirmed"),meta.isOnline=!0},onDeviceOffline:function(){console.log("Internet connection unavailable"),meta.isOnline=!1},onAppLoad:function(){},onAppPaused:function(){console.log("App sent to background")},onAppResumed:function(){console.log("App resumed from background")},setLocale:function(){meta.locale="en-CA",navigator.globalization.getPreferredLanguage(function(l){meta.locale=l.value},function(e){console.error("Couldn't get the system locale."),console.error(e)}),moment.locale(meta.locale)}};